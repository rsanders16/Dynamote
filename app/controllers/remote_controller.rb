class RemoteController < ApplicationController
 layout :resolve_layout
 
  def resolve_layout
    case params[:action]
    when "click"
      "blank"
    else
      "mobile"
    end
  end
 
  def index
    
  end
  
  def click
	@buttonid = params[:button_id];
	@button = Button.where(:id => @buttonid).first()
	@icon = AvailibleIcon.where(:id => @button.icon_id).first()
	puts "caca"
	puts @icon.id
	puts @icon.hex_code
	if @icon.hex_code.length > 3
		itachSendCommand(@icon.hex_code)
	end
    render :inline => "<empty></empty>"
  end
  
  require 'socket'

	def itachSendCommand(ircode)
	socket = TCPSocket.new '10.0.1.199', 4998

	#AppleTV Commands!!!!!!!!!
	#AppleTV UP
	#socket.print "sendir,1:1,1,37000,1,1,173,173,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,173,19,57,19,57,19,57,19,20,19,20,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,57,19,57,19,57,19,57,19,57,19,57,19,2038\r"
	#AppleTV Down
	#socket.print "sendir,1:1,1,37000,1,1,173,173,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,173,19,57,19,57,19,57,19,20,19,57,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,57,19,57,19,57,19,57,19,57,19,57,19,2039\r"
	#AppleTV Left
	#socket.print "sendir,1:1,1,37000,1,1,172,171,19,19,19,19,19,19,19,19,19,19,19,56,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,171,19,56,19,56,19,56,19,19,19,19,19,19,19,56,19,19,19,19,19,19,19,19,19,19,19,56,19,56,19,19,19,56,19,56,19,56,19,56,19,56,19,2020\r"
	#AppleTV Right
	#socket.print "sendir,1:1,1,37000,1,1,173,173,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,173,19,57,19,57,19,57,19,20,19,57,19,20,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,57,19,57,19,57,19,57,19,57,19,2039\r"
	#AppleTV Select
	#socket.print "sendir,1:1,1,37000,1,1,173,173,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,173,19,57,19,57,19,57,19,20,19,20,19,57,19,57,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,20,19,57,19,57,19,57,19,57,19,57,19,2039\r"
	#AppleTV Menu
	#socket.print "sendir,1:1,1,37000,1,1,172,173,19,20,19,20,19,20,19,20,19,20,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,173,19,57,19,57,19,57,19,20,19,57,19,57,19,57,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,57,19,57,19,57,19,57,19,57,19,2036\r"

	socket.print ircode+"\r"
	puts socket.recv(100)
  end

end
